<%#
#  Copyright 2009 Swansea University.
# 
#  Licensed under the Apache License, Version 2.0 (the "License");
#  you may not use this file except in compliance with the License.
#  You may obtain a copy of the License at
# 
#       http://www.apache.org/licenses/LICENSE-2.0
# 
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.
#  under the License.
%>
<p>
  <strong>Staff number</strong>: <%= staff.staff_id %> <br />
  <strong>Research centre</strong>: <%= h(staff.research_centre.title) %>  <br />
  <strong>Approved loading</strong>: <%= h(staff.loading) %>
</p>


<h3>Unallocated projects</h3>
<table border="0">
  <thead><th>Number</th><th>Title</th></thead>
  <tbody>
    <%= render(:partial => "admin/supervisors/project", :collection => staff.projects.find(:all).select { |p| ! p.allocated? }) %>
  </tbody>
</table>

<% if staff.load > 0 %>
<h3>Allocated projects</h3>
<table border="0">
  <thead><th>Number</th><th>Title</th><th>Allocated to</th></thead>
  <tbody>
    <%= render(:partial => "admin/supervisors/allocated_project", :collection => staff.projects.find(:all, :conditions => ['allocated = ?', true])) %>
  </tbody>
</table>
<%  end %>

<h3>Additional notes</h3>
<% if staff.user.has_role?("admin") %> %>
  <%= h(staff.user.name) %> is an administrator.
<% end %>
<% if staff.user.has_role?("coordinator") %>
  <%= h(staff.user.name) %> is the coordinator
  <% if staff.user.has_role?("admin") %>
    for all research centres.
  <% else %>
    for <%= h(staff.research_centre.title) %>.
  <% end %>
<% end %>
</p>
